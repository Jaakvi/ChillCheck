import{f as l}from"./fetch-qug4428q.js";async function p(){const o="https://hyte-server-aura.northeurope.cloudapp.azure.com/api/auth/me",t={method:"GET",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};l(o,t).then(e=>{document.getElementById("name").innerText=e.user.username})}p();async function i(){const o="https://hyte-server-aura.northeurope.cloudapp.azure.com/api/auth/me",t={method:"GET",headers:{Authorization:"Bearer "+localStorage.getItem("token")}};try{const e=await fetch(o,t);if(!e.ok)throw new Error("Failed to fetch user data. Status: "+e.status);const r=await e.json();if(!r.user||!r.user.user_id)throw new Error("Invalid response format. User ID not found.");return r.user.user_id}catch(e){return console.error("Error fetching user ID:",e.message),null}}function m(){document.querySelector(".update").addEventListener("click",async n=>{n.preventDefault(),console.log("nyt päivitetään tunnusta");const t=document.querySelector(".addform"),e=localStorage.getItem("token"),c=`https://hyte-server-aura.northeurope.cloudapp.azure.com/api/users/${i()}`,s={username:t.querySelector("input[name=username]").value,password:t.querySelector("input[name=password]").value,email:t.querySelector("input[name=email]").value},u={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer: "+e},body:JSON.stringify(s)};l(c,u).then(a=>{alert(a.message),console.log(a),location.href="index.html"})})}m();async function h(){document.querySelector(".del").addEventListener("click",async n=>{n.preventDefault(),console.log("poistettu"),console.log(n);let t=localStorage.getItem("token");const e=`https://hyte-server-aura.northeurope.cloudapp.azure.coms/api/users/${await i()}`,r={method:"DELETE",headers:{Authorization:"Bearer: "+t}};confirm(`Oletko varma, että haluat poistaa käyttäjän ${await i()}`)&&l(e,r).then(s=>{console.log(s)})})}h();const y=document.querySelector(".clearButton");y.addEventListener("click",g);async function g(){localStorage.removeItem("token"),alert("You have logged out"),location.href="index.html"}const S=document.querySelector(".get_entry");S.addEventListener("click",f);async function f(){const o="https://hyte-server-aura.northeurope.cloudapp.azure.com/api/entries",t={method:"GET",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};l(o,t).then(e=>{v(e)})}function v(o){console.log(o[0]);const n=document.querySelector(".card-area");n.innerHTML="",o[0].forEach(t=>{console.log(t.entry_date,t.entry_id);const e=document.createElement("tr"),r=document.createElement("td"),c=document.createElement("td"),s=document.createElement("td"),u=document.createElement("td");r.innerText=t.entry_date,c.innerText=t.entry_id,u.innerText=t.notes;const a=document.createElement("button");a.className="del",a.setAttribute("data-id",t.entry_id),a.innerText="Delete",s.appendChild(a),a.addEventListener("click",E),e.appendChild(r),e.appendChild(c),e.appendChild(s),e.appendChild(u),n.appendChild(e)})}function E(o){console.log("poistettu"),console.log(o);const n=o.target.attributes["data-id"].value;console.log(n);const t=o.target.parentElement.nextElementSibling.textContent;console.log("tapa 2: ",t);const e=`https://hyte-server-aura.northeurope.cloudapp.azure.coms/api/entries/${n}`,c={method:"DELETE",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};confirm(`Oletko varma, että haluat poistaa käyttäjän ${n}`)&&l(e,c).then(u=>{console.log(u)})}function k(o){document.querySelector(".createEntry").addEventListener("click",async t=>{t.preventDefault(),console.log("lisätään Diary entry");const e=document.querySelector(".create_entry_form"),r=localStorage.getItem("token"),c="https://hyte-server-aura.northeurope.cloudapp.azure.com/api/entries",s={user_id:e.querySelector("input[name=ID]").value,entry_date:e.querySelector("input[name=entry_date]").value,mood:e.querySelector("input[name=mood]").value,weight:e.querySelector("input[name=weight]").value,sleep_hours:e.querySelector("input[name=sleep_hours]").value,notes:e.querySelector("input[name=notes]").value},u={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer: "+r},body:JSON.stringify(s)};l(c,u).then(a=>{alert(a),console.log(a)})})}k();function q(o){document.querySelector(".EntryUpdate").addEventListener("click",async t=>{t.preventDefault(),console.log("Päivitetään Diary entryä");const e=document.querySelector(".updateEntry"),r=localStorage.getItem("token"),s=`https://hyte-server-aura.northeurope.cloudapp.azure.com/api/entries/${e.querySelector("input[name=EntryID]").value}`,u={user_id:e.querySelector("input[name=ID]").value,entry_date:e.querySelector("input[name=entry_date]").value,mood:e.querySelector("input[name=mood]").value,weight:e.querySelector("input[name=weight]").value,sleep_hours:e.querySelector("input[name=sleep_hours]").value,notes:e.querySelector("input[name=notes]").value},a={method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer: "+r},body:JSON.stringify(u)};l(s,a).then(d=>{alert(d.message),console.log(d)})})}q();
